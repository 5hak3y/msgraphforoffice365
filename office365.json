{
    "appid": "0a0a4087-10e8-4c96-9872-b740ff26d8bb",
    "name": "MS Graph for Office 365",
    "description": "Connects to Office 365 using the MS Graph API",
    "type": "email",
    "product_vendor": "Microsoft",
    "logo": "office365.png",
    "product_name": "Office 365 (MS Graph)",
    "product_version_regex": ".*",
    "publisher": "Phantom",
    "license": "Copyright (c) Phantom Cyber Corporation, 2017",
    "app_version": "1.0.9",
    "utctime_updated": "2017-12-12T21:02:15.000000Z",
    "package_name": "phantom_msgraphoffice365",
    "main_module": "office365_connector.pyc",
    "min_phantom_version": "3.0.251",
    "app_wizard_version": "1.0.0",
    "rest_handler": "office365_connector.handle_request",
    "configuration": {
        "tenant": {
            "description": "Tenant (e.g. contoso.onmicrosoft.com)",
            "data_type": "string",
            "required": true,
            "order": 0
        },
        "ph": {
            "data_type": "ph",
            "order": 1
        },
        "client_id": {
            "description": "Application ID",
            "data_type": "string",
            "required": true,
            "order": 2
        },
        "client_secret": {
            "description": "Application Secret",
            "data_type": "password",
            "required": true,
            "order": 3
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "identifier": "test_connectivity",
            "description": "Use supplied credentials to generate a token with MS Graph",
            "type": "test",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "copy email",
            "identifier": "copy_email",
            "description": "Copy an email to a folder",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "id": {
                    "description": "Message ID to copy",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "email id"
                    ],
                    "order": 0
                },
                "email_address": {
                    "description": "Source Mailbox (Email)",
                    "data_type": "string",
                    "required": true,
                    "contains": [
                        "email"
                    ],
                    "order": 1
                },
                "folder": {
                    "description": "Destination Mail Folder Name/Path",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "mail folder",
                        "mail folder path"
                    ],
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.id",
                    "data_type": "string",
                    "contains": [
                        "email id"
                    ],
                    "example_values": [
                        "AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAADyW3X5P7Hb0_MMHKonvdoWQcAQSl1b8BFiEmbqZql_JiUtwAAAgEMAAAAQSl1b8BFiEmbqZql_JiUtwABS2DpdwAAAA=="
                    ]
                },
                {
                    "data_path": "action_result.parameter.email_address",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "column_name": "email",
                    "column_order": 0,
                    "example_values": [
                        "herman@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.parameter.folder",
                    "data_type": "string",
                    "contains": [
                        "mail folder",
                        "mail folder path"
                    ],
                    "column_name": "folder",
                    "column_order": 1,
                    "example_values": [
                        "AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQAuAAADyW3X5P7Hb0_MMHKonvdoWQEAQSl1b8BFiEmbqZql_JiUtwAAAgEbAAAA"
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Successfully copied email"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.sentDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-25T22:28:57Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.conversationId",
                    "data_type": "string",
                    "example_values": [
                        "AAQkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQAQANDpL7xEHORGgd1idbVXqcg="
                    ]
                },
                {
                    "data_path": "action_result.data.*.isDraft",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.internetMessageId",
                    "data_type": "string",
                    "example_values": [
                        "<CABO4XoNKorysqU1nR=of7qDBFbR1cv9icBSb38M=g3ryBb=CrA@mail.gmail.com>"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "column_name": "New Email ID",
                    "column_order": 2,
                    "contains": [
                        "email id"
                    ],
                    "example_values": [
                        "AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAADyW3X5P7Hb0_MMHKonvdoWQcAQSl1b8BFiEmbqZql_JiUtwAAAgEbAAAAQSl1b8BFiEmbqZql_JiUtwABUH-stgAAAA=="
                    ]
                },
                {
                    "data_path": "action_result.data.*.isReadReceiptRequested",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.subject",
                    "data_type": "string",
                    "example_values": [
                        "more body formats?"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.type",
                    "data_type": "string",
                    "example_values": [
                        "#microsoft.graph.message"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ccRecipients.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ccRecipients.email",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.bodyPreview",
                    "data_type": "string",
                    "example_values": [
                        "plain text?"
                    ]
                },
                {
                    "data_path": "action_result.data.*.from.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.from.emailAddress.address",
                    "data_type": "string",
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://graph.microsoft.com/v1.0/$metadata#message"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.replyTo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.changeKey",
                    "data_type": "string",
                    "example_values": [
                        "CQAAABYAAABBKXVvwEWISZupmqX4mJS3AAFQwHj9"
                    ]
                },
                {
                    "data_path": "action_result.data.*.receivedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-25T22:29:01Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.parentFolderId",
                    "data_type": "string",
                    "contains": [
                        "mail folder",
                        "mail folder path"
                    ],
                    "example_values": [
                        "AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQAuAAADyW3X5P7Hb0_MMHKonvdoWQEAQSl1b8BFiEmbqZql_JiUtwAAAgEbAAAA"
                    ]
                },
                {
                    "data_path": "action_result.data.*.body.content",
                    "data_type": "string",
                    "example_values": [
                        "plain text?\r\n"
                    ]
                },
                {
                    "data_path": "action_result.data.*.body.contentType",
                    "data_type": "string",
                    "example_values": [
                        "text"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isDeliveryReceiptRequested",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.importance",
                    "data_type": "string",
                    "example_values": [
                        "normal"
                    ]
                },
                {
                    "data_path": "action_result.data.*.toRecipients.*.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Herman Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.toRecipients.*.emailAddress.address",
                    "data_type": "string",
                    "example_values": [
                        "Herman@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastModifiedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-11-02T23:58:59Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isRead",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.categories",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sender.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.sender.emailAddress.address",
                    "data_type": "string",
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.hasAttachments",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.webLink",
                    "data_type": "string",
                    "example_values": [
                        "https://outlook.office365.com/owa/?ItemID=AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAADyW3X5P7Hb0%2BMMHKonvdoWQcAQSl1b8BFiEmbqZql%2BJiUtwAAAgEbAAAAQSl1b8BFiEmbqZql%2BJiUtwABUH%2FstgAAAA%3D%3D&exvsurl=1&viewmodel=ReadMessageItem"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.createdDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-25T22:29:01Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.bccRecipients.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.bccRecipients.email",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.inferenceClassification",
                    "data_type": "string",
                    "example_values": [
                        "focused"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.etag",
                    "data_type": "string",
                    "example_values": [
                        "W/\"CQAAABYAAABBKXVvwEWISZupmqX4mJS3AAFQwHj9\""
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                }
            ],
            "versions": "EQ(*)",
            "render": {
                "width": 12,
                "title": "Copy Email",
                "type": "table",
                "height": 5
            }
        },
        {
            "action": "delete email",
            "identifier": "delete_email",
            "description": "Delete emails",
            "type": "contain",
            "read_only": false,
            "parameters": {
                "id": {
                    "description": "Message IDs to delete",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "email id"
                    ],
                    "order": 0
                },
                "email_address": {
                    "description": "Email address of the mailbox owner",
                    "data_type": "string",
                    "required": true,
                    "primary": false,
                    "contains": [
                        "email"
                    ],
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.id",
                    "data_type": "string",
                    "contains": [
                        "email id"
                    ],
                    "column_name": "id",
                    "column_order": 0
                },
                {
                    "data_path": "action_result.parameter.email_address",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "column_name": "email",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 2
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string"
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric"
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric"
                }
            ],
            "versions": "EQ(*)"
        },
        {
            "action": "get email",
            "identifier": "get_email",
            "description": "Get an email from the server",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "id": {
                    "description": "Message ID to get",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "email id"
                    ],
                    "order": 0
                },
                "email_address": {
                    "description": "Email address of the mailbox owner",
                    "data_type": "string",
                    "required": true,
                    "primary": false,
                    "contains": [
                        "email"
                    ],
                    "order": 1
                },
                "download_attachments": {
                    "description": "Download attachments to vault",
                    "data_type": "boolean",
                    "required": true,
                    "primary": false,
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.id",
                    "data_type": "string",
                    "contains": [
                        "email id"
                    ],
                    "example_values": [
                        "AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAADyW3X5P7Hb0_MMHKonvdoWQcAQSl1b8BFiEmbqZql_JiUtwAAAgEMAAAAQSl1b8BFiEmbqZql_JiUtwABS2DpfAAAAA=="
                    ]
                },
                {
                    "data_path": "action_result.parameter.email_address",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "column_name": "email",
                    "column_order": 1
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "status",
                    "column_order": 2,
                    "example_values": [
                        "success"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        ""
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.sentDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-26T01:31:35Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.conversationId",
                    "data_type": "string",
                    "example_values": [
                        "AAQkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQAQAEU43FQ-fk5LmOxKoTpmHfw="
                    ]
                },
                {
                    "data_path": "action_result.data.*.isDraft",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.internetMessageId",
                    "data_type": "string",
                    "example_values": [
                        "<CABO4XoP4y0jiKDGWr5yQ=-AwrRC-Vbc4LSNju1-Mroxrwn=Rrg@mail.gmail.com>"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "example_values": [
                        "AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAADyW3X5P7Hb0_MMHKonvdoWQcAQSl1b8BFiEmbqZql_JiUtwAAAgEMAAAAQSl1b8BFiEmbqZql_JiUtwABS2DpfAAAAA=="
                    ]
                },
                {
                    "data_path": "action_result.data.*.isReadReceiptRequested",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.subject",
                    "data_type": "string",
                    "column_name": "Subject",
                    "column_order": 0,
                    "example_values": [
                        "more attachments"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ccRecipients.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ccRecipients.email",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.bodyPreview",
                    "data_type": "string",
                    "column_name": "Body Preview",
                    "column_order": 1,
                    "example_values": [
                        "Have a good time with these."
                    ]
                },
                {
                    "data_path": "action_result.data.*.from.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.from.emailAddress.address",
                    "data_type": "string",
                    "column_name": "From",
                    "column_order": 2,
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.context",
                    "data_type": "string",
                    "example_values": [
                        "https://graph.microsoft.com/v1.0/$metadata#users('herman%40phantomengineering.onmicrosoft.com')/messages/$entity"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.replyTo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.changeKey",
                    "data_type": "string",
                    "example_values": [
                        "CQAAABYAAABBKXVvwEWISZupmqX4mJS3AAFLoCsS"
                    ]
                },
                {
                    "data_path": "action_result.data.*.receivedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-26T01:31:43Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.parentFolderId",
                    "data_type": "string",
                    "contains": [
                        "mail folder",
                        "mail folder path"
                    ],
                    "example_values": [
                        "AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQAuAAADyW3X5P7Hb0_MMHKonvdoWQEAQSl1b8BFiEmbqZql_JiUtwAAAgEMAAAA"
                    ]
                },
                {
                    "data_path": "action_result.data.*.body.content",
                    "data_type": "string",
                    "example_values": [
                        "Have a good time with these.\r\n"
                    ]
                },
                {
                    "data_path": "action_result.data.*.body.contentType",
                    "data_type": "string",
                    "example_values": [
                        "text"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isDeliveryReceiptRequested",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.importance",
                    "data_type": "string",
                    "example_values": [
                        "normal"
                    ]
                },
                {
                    "data_path": "action_result.data.*.toRecipients.*.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Herman Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.toRecipients.*.emailAddress.address",
                    "data_type": "string",
                    "column_name": "To",
                    "column_order": 3,
                    "example_values": [
                        "Herman@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastModifiedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-26T01:31:43Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isRead",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.categories",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sender.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.sender.emailAddress.address",
                    "data_type": "string",
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.hasAttachments",
                    "data_type": "boolean",
                    "column_name": "Has Attachments",
                    "column_order": 4,
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.webLink",
                    "data_type": "string",
                    "example_values": [
                        "https://outlook.office365.com/owa/?ItemID=AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAADyW3X5P7Hb0%2BMMHKonvdoWQcAQSl1b8BFiEmbqZql%2BJiUtwAAAgEMAAAAQSl1b8BFiEmbqZql%2BJiUtwABS2DpfAAAAA%3D%3D&exvsurl=1&viewmodel=ReadMessageItem"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.@odata.type",
                    "data_type": "string",
                    "example_values": [
                        "#microsoft.graph.fileAttachment"
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.lastModifiedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-26T01:31:43Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.contentType",
                    "data_type": "string",
                    "example_values": [
                        "text/plain"
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.name",
                    "data_type": "string",
                    "example_values": [
                        "attachment.txt"
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.contentId",
                    "data_type": "string",
                    "example_values": [
                        "F5832F4CF6EFEC41B9CBC6DED238A234@namprd18.prod.outlook.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.id",
                    "data_type": "string",
                    "example_values": [
                        "AQMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAADyW3X5P7Hb0_MMHKonvdoWQcAQSl1b8BFiEmbqZql_JiUtwAAAgEMAAAAQSl1b8BFiEmbqZql_JiUtwABS2DpfAAAAAESABAA0EuDIoiFb0ifXM0ETmQMVw=="
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.vaultId",
                    "data_type": "string",
                    "example_values": [
                        "719dbf72d7c0bc89d7e34306c08a0b66191902b9"
                    ],
                    "contains": [
                        "sha1"
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.isInline",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.attachments.*.contentLocation",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.attachments.*.size",
                    "data_type": "numeric",
                    "example_values": [
                        355
                    ]
                },
                {
                    "data_path": "action_result.data.*.createdDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-26T01:31:43Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.bccRecipients.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.bccRecipients.email",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.inferenceClassification",
                    "data_type": "string",
                    "example_values": [
                        "focused"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.etag",
                    "data_type": "string",
                    "example_values": [
                        "W/\"CQAAABYAAABBKXVvwEWISZupmqX4mJS3AAFLoCsS\""
                    ]
                },
                {
                    "data_path": "action_result.parameter.download_attachments",
                    "data_type": "string",
                    "example_values": [
                        "true"
                    ]
                },
                {
                    "data_path": "action_result.summary",
                    "data_type": "string"
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "run query",
            "identifier": "run_query",
            "description": "Search emails",
            "verbose": "If the <b>query</b> or <b>internet_message_id</b> parameters are included, the <b>subject</b>, <b>sender</b>, <b>body</b>, and <b>range</b> parameters will be ignored. The <b>internet_message_id</b> parameter will take precedence over the <b>query</b> parameter.<br><br>For information on formatting the <b>query</b> parameter, see https://developer.microsoft.com/en-us/graph/docs/concepts/query_parameters.<br><br>If the <b>limit</b> parameter is not included, the action will default to limiting to ten emails that match the rest of the query.",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "email_address": {
                    "description": "User's email (Mailbox to search in)",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "email"
                    ],
                    "order": 0
                },
                "folder": {
                    "description": "Folder Name/Path (to search in)",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "contains": [
                        "mail folder",
                        "mail folder path"
                    ],
                    "default": "Inbox",
                    "order": 1
                },
                "subject": {
                    "description": "Substring to search in Subject",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "order": 2
                },
                "body": {
                    "description": "Substring to search in Body",
                    "data_type": "string",
                    "order": 3,
                    "primary": false,
                    "required": false
                },
                "sender": {
                    "description": "Sender email address to match",
                    "data_type": "string",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "email"
                    ],
                    "order": 4
                },
                "limit": {
                    "description": "Maximum emails to return",
                    "data_type": "numeric",
                    "required": false,
                    "primary": false,
                    "default": "10",
                    "order": 5
                },
                "query": {
                    "description": "MS Graph query string",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "order": 6
                },
                "internet_message_id": {
                    "description": "Internet Message ID",
                    "data_type": "string",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "internet message id"
                    ],
                    "order": 7
                }
            },
            "output": [
                {
                    "data_path": "action_result.parameter.email_address",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "example_values": [
                        "herman@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.parameter.folder",
                    "data_type": "string",
                    "contains": [
                        "mail folder",
                        "mail folder path"
                    ],
                    "example_values": [
                        "Archive"
                    ]
                },
                {
                    "data_path": "action_result.parameter.subject",
                    "data_type": "string",
                    "example_values": [
                        "Just wanted to say hello"
                    ]
                },
                {
                    "data_path": "action_result.parameter.sender",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.parameter.body",
                    "data_type": "string",
                    "example_values": [
                        "How are you doing this fine evening?"
                    ]
                },
                {
                    "data_path": "action_result.parameter.internet_message_id",
                    "data_type": "string",
                    "contains": [
                        "internet message id"
                    ]
                },
                {
                    "data_path": "action_result.parameter.query",
                    "data_type": "string",
                    "example_values": [
                        "$top=5&skip=10&filter=contains(subject,'Urgent')"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "string",
                    "example_values": [
                        5
                    ]
                },
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Emails matched: 1"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.data.*.sentDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-30T22:32:37Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.conversationId",
                    "data_type": "string",
                    "example_values": [
                        "AAQkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQAQAGqbDRkVLxZMtetM-dKqAPo="
                    ]
                },
                {
                    "data_path": "action_result.data.*.internetMessageId",
                    "data_type": "string",
                    "example_values": [
                        "<CABO4XoM2X=z02-=jmuvtis3MUxHgvTcH7vkVgVC=dwcuN5yT6Q@mail.gmail.com>"
                    ]
                },
                {
                    "data_path": "action_result.data.*.id",
                    "data_type": "string",
                    "column_name": "ID",
                    "column_order": 4,
                    "contains": [
                        "email id"
                    ],
                    "example_values": [
                        "AAMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAAAAADJbdfk-sdvT4wwcqie92hZBwBBKXVvwEWISZupmqX4mJS3AACEV3zJAABBKXVvwEWISZupmqX4mJS3AAFOZwS4AAA="
                    ]
                },
                {
                    "data_path": "action_result.data.*.isReadReceiptRequested",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.subject",
                    "data_type": "string",
                    "column_name": "Subject",
                    "column_order": 2,
                    "example_values": [
                        "Just wanted to say hello"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ccRecipients.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.ccRecipients.email",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.bodyPreview",
                    "data_type": "string",
                    "column_name": "Body",
                    "column_order": 3,
                    "example_values": [
                        "How are you doing this fine evening?"
                    ]
                },
                {
                    "data_path": "action_result.data.*.from.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.from.emailAddress.address",
                    "data_type": "string",
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isDraft",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.replyTo",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.changeKey",
                    "data_type": "string",
                    "example_values": [
                        "CQAAABYAAABBKXVvwEWISZupmqX4mJS3AAFOpxtE"
                    ]
                },
                {
                    "data_path": "action_result.data.*.receivedDateTime",
                    "data_type": "string",
                    "column_name": "Received Time",
                    "column_order": 1,
                    "example_values": [
                        "2017-10-30T22:32:42Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.parentFolderId",
                    "data_type": "string",
                    "contains": [
                        "mail folder",
                        "mail folder path"
                    ],
                    "example_values": [
                        "AAMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQAuAAAAAADJbdfk-sdvT4wwcqie92hZAQBBKXVvwEWISZupmqX4mJS3AACEV3zJAAA="
                    ]
                },
                {
                    "data_path": "action_result.data.*.body.content",
                    "data_type": "string",
                    "example_values": [
                        "How are you doing this fine evening?\r\n"
                    ]
                },
                {
                    "data_path": "action_result.data.*.body.contentType",
                    "data_type": "string",
                    "example_values": [
                        "text"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isDeliveryReceiptRequested",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.importance",
                    "data_type": "string",
                    "example_values": [
                        "normal"
                    ]
                },
                {
                    "data_path": "action_result.data.*.toRecipients.*.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Herman Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.toRecipients.*.emailAddress.address",
                    "data_type": "string",
                    "example_values": [
                        "Herman@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.lastModifiedDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-30T22:32:53Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.isRead",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.categories",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.data.*.sender.emailAddress.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.sender.emailAddress.address",
                    "data_type": "string",
                    "column_name": "Sender",
                    "column_order": 0,
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ],
                    "contains": [
                        "email"
                    ]
                },
                {
                    "data_path": "action_result.data.*.createdDateTime",
                    "data_type": "string",
                    "example_values": [
                        "2017-10-30T22:32:42Z"
                    ]
                },
                {
                    "data_path": "action_result.data.*.webLink",
                    "data_type": "string",
                    "example_values": [
                        "https://outlook.office365.com/owa/?ItemID=AAMkADU3NDk3MzJlLTY3MDQtNDE2Ny1iZDk1LTc4YjEwYzhmZDc5YQBGAAAAAADJbdfk%2FsdvT4wwcqie92hZBwBBKXVvwEWISZupmqX4mJS3AACEV3zJAABBKXVvwEWISZupmqX4mJS3AAFOZwS4AAA%3D&exvsurl=1&viewmodel=ReadMessageItem"
                    ],
                    "contains": [
                        "url"
                    ]
                },
                {
                    "data_path": "action_result.data.*.hasAttachments",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.bccRecipients.name",
                    "data_type": "string",
                    "example_values": [
                        "Susan Edwards"
                    ]
                },
                {
                    "data_path": "action_result.data.*.bccRecipients.email",
                    "data_type": "string",
                    "contains": [
                        "email"
                    ],
                    "example_values": [
                        "susan@phantomengineering.onmicrosoft.com"
                    ]
                },
                {
                    "data_path": "action_result.data.*.inferenceClassification",
                    "data_type": "string",
                    "example_values": [
                        "focused"
                    ]
                },
                {
                    "data_path": "action_result.data.*.@odata.etag",
                    "data_type": "string",
                    "example_values": [
                        "W/\"CQAAABYAAABBKXVvwEWISZupmqX4mJS3AAFOpxtE\""
                    ]
                },
                {
                    "data_path": "action_result.summary.emails_matched",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        }
    ]
}